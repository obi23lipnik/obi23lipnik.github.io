<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    function convertDateToAnotherTimeZone(date, timezone) {
        const dateString = date.toLocaleString('en-US', {
          timeZone: timezone
        });
        return new Date(dateString);
    }
    google.charts.load('current', {packages: ['corechart', 'line']});
    google.charts.setOnLoadCallback(drawLineColors);
    async function drawLineColors() {
        var data = new google.visualization.DataTable();
        const url = "http://139.59.140.143:82/?chart=true"
        data.addColumn('datetime', 'Time');
        data.addColumn('number', 'QBit-USD');
        let response
        let resdata
        let dataSeries = []
        var options
        var chart
        response = await fetch(url, {
            mode: 'cors',
            headers: {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': 'https://obi23lipnik.github.io',
            },
            credentials: 'same-origin',
            referrerPolicy: 'no-referrer',
        });
        resdata = await response.json()
        for (const dataEntry of resdata) {
            const dateObjUTC = new Date(dataEntry[0])
            const dateObjBER = convertDateToAnotherTimeZone(dateObjUTC, 'Europe/Berlin');
            dataSeries.push([dateObjBER, dataEntry[1]])
        }
        data.addRows(dataSeries);

        var options = {
            hAxis: {
            title: 'Time'
            },
            vAxis: {
            title: 'Price'
            },
            colors: ['#a52714'],
            height: 800,
            animation:{
                duration: 400,
                easing: 'in',
              },
            explorer: { 
                actions: ['dragToZoom', 'rightClickToReset'],
                axis: 'horizontal',
                keepInBounds: false,
                maxZoomIn: 4.0,
            },
        };

        chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    }
</script>
<div id="chart_div"></div>

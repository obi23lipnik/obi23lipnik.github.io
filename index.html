<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
    google.charts.load('current', {packages: ['corechart', 'line']});
    google.charts.setOnLoadCallback(drawLineColors);
    async function drawLineColors() {
        var data = new google.visualization.DataTable();
        const url = "http://139.59.140.143:82/?chart=true"
        data.addColumn('datetime', 'Time');
        data.addColumn('number', 'QBit-USD');
        let response
        let resdata
        let dataSeries = []
        var options
        var chart
        response = await fetch(url, {
            mode: 'cors',
            headers: {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': 'https://obi23lipnik.github.io',
            },
            credentials: 'same-origin',
            referrerPolicy: 'no-referrer',
        });
        resdata = await response.json()
        for (const dataEntry of resdata) {
            const dateObj = new Date(dataEntry[0])
            dataSeries.push([dateObj, dataEntry[1]])
        }
        data.addRows(dataSeries);
        var dateFormat = new google.visualization.DateFormat({formatType: 'long', timeZone: 2});
        dateFormat.format(data, 0)
        var xTicks = [];
        for (var i = 0; i < data.getNumberOfRows(); i++) {
          xTicks.push({
            v: data.getValue(i, 0),
            f: data.getFormattedValue(i, 0)
          });
        }
        var options = {
            hAxis: {
                title: 'Time',
                ticks: xTicks
            },
            vAxis: {
                title: 'Price'
            },
            colors: ['#a52714'],
            height: 800,
            animation:{
                duration: 400,
                easing: 'in',
              },
            explorer: { 
                actions: ['dragToZoom', 'rightClickToReset'],
                axis: 'horizontal',
                keepInBounds: false,
                maxZoomIn: 4.0,
            },
        };

        chart = new google.visualization.LineChart(document.getElementById('chart_div'));
        chart.draw(data, options);
    }
</script>
<div id="chart_div"></div>
